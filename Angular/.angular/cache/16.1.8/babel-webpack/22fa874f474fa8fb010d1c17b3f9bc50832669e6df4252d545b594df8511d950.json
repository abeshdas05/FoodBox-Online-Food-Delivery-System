{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { User } from '../model-classes/user.model';\nexport let FoodListComponent = class FoodListComponent {\n  constructor(service) {\n    this.service = service;\n    this.user = new User();\n    this.userEmail = sessionStorage.getItem('userSession');\n    this.foodItems = [];\n    this.quantities = [];\n    this.filteredFoodItems = [];\n    this.categories = [];\n    this.selectedCategory = null;\n    this.searchQuery = '';\n    this.selectedSortOption = 'default';\n    this.alertMessage = '';\n  }\n  ngOnInit() {\n    this.getUser();\n    this.getCategories();\n    this.getFoodItems();\n  }\n  getUser() {\n    console.log(this.userEmail);\n    this.service.getUserByEmail(this.userEmail).subscribe(user => {\n      this.user = user;\n      console.log(this.user);\n    });\n  }\n  getCategories() {\n    this.service.getCategories().subscribe(categories => {\n      this.categories = categories;\n    });\n  }\n  getFoodItems() {\n    this.service.getFoodItems().subscribe(foodItems => {\n      this.foodItems = foodItems;\n      this.filteredFoodItems = foodItems;\n      this.initializeQuantities();\n    });\n  }\n  initializeQuantities() {\n    this.quantities = new Array(this.foodItems.length).fill(1);\n  }\n  addToCart(foodItem, quantity) {\n    if (quantity <= 0) {\n      this.showAlertModal('Please select a valid quantity');\n    } else if (quantity <= foodItem.availableQuantity) {\n      this.service.addToCart(foodItem.foodItemId, quantity, this.user.userId).subscribe(() => {\n        console.log(foodItem.foodItemId, quantity);\n        foodItem.availableQuantity = foodItem.availableQuantity - quantity;\n        this.service.editFoodItem(foodItem).subscribe(() => {});\n        this.getFoodItems();\n        this.showSuccessModal();\n      });\n    } else {\n      this.showAlertModal('Quantity exceeds available quantity');\n    }\n  }\n  showSuccessModal() {\n    const modal = document.getElementById('successModal');\n    if (modal) {\n      modal.style.display = 'block';\n    }\n  }\n  closeSuccessModal() {\n    const modal = document.getElementById('successModal');\n    if (modal) {\n      modal.style.display = 'none';\n    }\n  }\n  showAlertModal(message) {\n    const modal = document.getElementById('alertModal');\n    this.alertMessage = message;\n    if (modal) {\n      modal.style.display = 'block';\n    }\n  }\n  closeAlertModal() {\n    const modal = document.getElementById('alertModal');\n    if (modal) {\n      modal.style.display = 'none';\n    }\n  }\n  increaseQuantity(i) {\n    this.quantities[i]++;\n  }\n  decreaseQuantity(i) {\n    this.quantities[i]--;\n  }\n  filterByCategory(category) {\n    this.selectedCategory = category;\n    if (category) {\n      this.filteredFoodItems = this.foodItems.filter(foodItem => foodItem.category.categoryId === category.categoryId);\n    } else {\n      this.filteredFoodItems = this.foodItems;\n    }\n  }\n  applyFilters() {\n    this.filterByCategory(this.selectedCategory);\n    this.filteredFoodItems = this.filteredFoodItems.filter(item => item.name.toLowerCase().includes(this.searchQuery.toLowerCase()));\n    if (this.selectedSortOption === 'lowToHigh') {\n      this.filteredFoodItems.sort((a, b) => a.actualPrice * (1 - a.offer / 100) - b.actualPrice * (1 - b.offer / 100));\n    } else if (this.selectedSortOption === 'highToLow') {\n      this.filteredFoodItems.sort((a, b) => b.actualPrice * (1 - b.offer / 100) - a.actualPrice * (1 - a.offer / 100));\n    }\n    if (this.searchQuery) {\n      this.filteredFoodItems = this.filteredFoodItems.filter(item => item.name.toLowerCase().includes(this.searchQuery.toLowerCase()));\n    }\n  }\n};\nFoodListComponent = __decorate([Component({\n  selector: 'app-food-list',\n  templateUrl: './food-list.component.html',\n  styleUrls: ['./food-list.component.css']\n})], FoodListComponent);","map":{"version":3,"names":["Component","User","FoodListComponent","constructor","service","user","userEmail","sessionStorage","getItem","foodItems","quantities","filteredFoodItems","categories","selectedCategory","searchQuery","selectedSortOption","alertMessage","ngOnInit","getUser","getCategories","getFoodItems","console","log","getUserByEmail","subscribe","initializeQuantities","Array","length","fill","addToCart","foodItem","quantity","showAlertModal","availableQuantity","foodItemId","userId","editFoodItem","showSuccessModal","modal","document","getElementById","style","display","closeSuccessModal","message","closeAlertModal","increaseQuantity","i","decreaseQuantity","filterByCategory","category","filter","categoryId","applyFilters","item","name","toLowerCase","includes","sort","a","b","actualPrice","offer","__decorate","selector","templateUrl","styleUrls"],"sources":["F:\\PP\\RLL\\FoodBox\\src\\app\\food-list\\food-list.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FoodBoxService } from '../food-box.service';\nimport { FoodItem } from '../model-classes/food-item.model';\nimport { Category } from '../model-classes/category.model';\nimport { User } from '../model-classes/user.model';\n\n@Component({\n  selector: 'app-food-list',\n  templateUrl: './food-list.component.html',\n  styleUrls: ['./food-list.component.css']\n})\nexport class FoodListComponent implements OnInit {\n  user:User=new User();\n  userEmail=sessionStorage.getItem('userSession');\n  constructor(private service: FoodBoxService) { }\n  foodItems: FoodItem[] = [];\n  quantities: number[] = [];\n  filteredFoodItems: FoodItem[] = [];\n  categories: Category[] = [];\n  selectedCategory: Category | null = null;\n  searchQuery = '';\n  selectedSortOption: string = 'default';\n  alertMessage='';\n  ngOnInit(): void {\n    this.getUser();\n    this.getCategories();\n    this.getFoodItems();\n  }\n  getUser(): void {\n    console.log(this.userEmail);\n\n    this.service.getUserByEmail(this.userEmail).subscribe(\n\n      user => {\n        this.user = user;\n        console.log(this.user);\n      }\n    )\n  }\n  getCategories() {\n    this.service.getCategories().subscribe(categories => {\n      this.categories = categories;\n\n    });\n  }\n\n  getFoodItems(): void {\n    this.service.getFoodItems().subscribe(foodItems => {\n      this.foodItems = foodItems;\n      this.filteredFoodItems = foodItems;\n      this.initializeQuantities();\n    });\n  }\n  \n  initializeQuantities(): void {\n    this.quantities = new Array(this.foodItems.length).fill(1);\n  }\n  addToCart(foodItem: FoodItem, quantity: number): void {\n    if (quantity <= 0) {\n      this.showAlertModal('Please select a valid quantity');\n    }\n    else if (quantity <= foodItem.availableQuantity) {\n      this.service.addToCart(foodItem.foodItemId, quantity,this.user.userId).subscribe(\n        () => {\n          console.log(foodItem.foodItemId,quantity);          \n          foodItem.availableQuantity=foodItem.availableQuantity-quantity;\n          this.service.editFoodItem(foodItem).subscribe(\n            ()=>{\n            \n            }\n          )\n          this.getFoodItems();\n          this.showSuccessModal();\n        }\n      );\n\n\n    } else {\n      this.showAlertModal('Quantity exceeds available quantity');\n    }\n  }\n  showSuccessModal(): void {\n    const modal = document.getElementById('successModal');\n    if (modal) {\n      modal.style.display = 'block';\n    }\n  }\n  closeSuccessModal(): void {\n    const modal = document.getElementById('successModal');\n    if (modal) {\n      modal.style.display = 'none';\n    }\n  }\n  showAlertModal(message:string): void {\n    const modal = document.getElementById('alertModal');\n    this.alertMessage=message;\n    if (modal) {\n      modal.style.display = 'block';\n    }\n  }\n  closeAlertModal(): void {\n    const modal = document.getElementById('alertModal');\n    if (modal) {\n      modal.style.display = 'none';\n    }\n  }\n  increaseQuantity(i: number): void {\n    this.quantities[i]++;\n  }\n\n  decreaseQuantity(i: number): void {\n    this.quantities[i]--;\n  }\n  filterByCategory(category: Category | null): void {\n    this.selectedCategory = category;\n    if (category) {\n      this.filteredFoodItems = this.foodItems.filter(\n        foodItem => foodItem.category.categoryId === category.categoryId\n        \n      );\n    } else {\n      this.filteredFoodItems = this.foodItems;\n    }\n  }\n  applyFilters(): void {\n    this.filterByCategory(this.selectedCategory);\n    this.filteredFoodItems = this.filteredFoodItems.filter(item =>\n      item.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n    );\n    if (this.selectedSortOption === 'lowToHigh') {\n      this.filteredFoodItems.sort((a, b) => a.actualPrice*(1-a.offer/100) - b.actualPrice*(1-b.offer/100));\n    } else if (this.selectedSortOption === 'highToLow') {\n      this.filteredFoodItems.sort((a, b) =>  b.actualPrice*(1-b.offer/100) -a.actualPrice*(1-a.offer/100));\n    }\n\n    if (this.searchQuery) {\n      this.filteredFoodItems = this.filteredFoodItems.filter(item =>\n        item.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n      );\n    }\n  }\n  \n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}